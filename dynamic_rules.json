{
  "version": "1.0",
  "last_updated": "2025-08-03",
  "description": "动态规则库配置",
  "analysis_rules": {
    "server_counting": {
      "description": "服务器数量统计规则",
      "priority": "high",
      "rules": [
        "默认一个需求是一个应用系统，除非用户需求表述多个应用系统",
        "仔细统计每个应用系统的服务器总数量，包括不同类型的服务器",
        "每台服务器都需要对应的ECS云服务器实例",
        "数据库、Redis软件等都需要安装在ECS云服务器上",
        "高可用架构至少需要2台服务器",
        "应用系统的默认等保等级是二级"
      ]
    },
    "service_mapping": {
      "description": "服务映射规则",
      "priority": "high",
      "rules": [
        "每个应用系统默认通过互联网提供服务",
        "每个应用系统配置1个弹性公网IP（默认10M带宽）",
        "每个应用系统通常只需要1个负载均衡SLB，，除非明确要求多个",
        "每个ECS云服务器默认1块100G系统盘，无数据盘"
      ]
    }
  },
  "service_types": {
    "ecs": {
      "name": "云服务器",
      "description": "每台默认配置100GB系统盘",
      "category": "compute",
      "mandatory": true,
      "auto_provision": false,
      "specs": [
        {
          "spec_name": "2C4G",
          "display": "2核4GB",
          "cpu": 2,
          "memory": 4
        },
        {
          "spec_name": "2C8G",
          "display": "2核8GB",
          "cpu": 2,
          "memory": 8
        },
        {
          "spec_name": "4C8G",
          "display": "4核8GB",
          "cpu": 4,
          "memory": 8
        },
        {
          "spec_name": "4C16G",
          "display": "4核16GB",
          "cpu": 4,
          "memory": 16
        },
        {
          "spec_name": "8C16G",
          "display": "8核16GB",
          "cpu": 8,
          "memory": 16
        },
        {
          "spec_name": "8C32G",
          "display": "8核32GB",
          "cpu": 8,
          "memory": 32
        },
        {
          "spec_name": "16C32G",
          "display": "16核32GB",
          "cpu": 16,
          "memory": 32
        },
        {
          "spec_name": "16C64G",
          "display": "16核64GB",
          "cpu": 16,
          "memory": 64
        },
        {
          "spec_name": "32C64G",
          "display": "32核64GB",
          "cpu": 32,
          "memory": 64
        },
        {
          "spec_name": "32C128G",
          "display": "32核128GB",
          "cpu": 32,
          "memory": 128
        }
      ]
    },
    "system_disk": {
      "name": "系统盘",
      "description": "默认100GB，按50GB递增",
      "category": "storage",
      "mandatory": false,
      "auto_provision": true,
      "default_size": 100,
      "increment": 50,
      "max_size": 1000
    },
    "data_disk": {
      "name": "数据盘",
      "description": "每台服务器最多1块，按50GB递增",
      "category": "storage",
      "mandatory": false,
      "auto_provision": false,
      "min_size": 50,
      "increment": 50,
      "max_size": 2000,
      "max_per_server": 1
    },
    "eip": {
      "name": "弹性公网IP",
      "description": "带宽选项：10M/20M/50M/100M/200M",
      "category": "network",
      "mandatory": false,
      "auto_provision": true,
      "bandwidth_options": [
        10,
        20,
        50,
        100,
        200
      ],
      "default_bandwidth": 10
    },
    "slb": {
      "name": "负载均衡SLB",
      "description": "规格匹配出口带宽：10M/20M/50M/100M/200M",
      "category": "network",
      "mandatory": false,
      "auto_provision": false,
      "recommended": true,
      "bandwidth_options": [
        10,
        20,
        50,
        100,
        200
      ]
    },
    "bastion_host": {
      "name": "堡垒机",
      "description": "ECS必须配置，根据服务器数量自动选择规格",
      "category": "security",
      "mandatory": true,
      "auto_provision": true,
      "specs": [
        {
          "spec_name": "license_1",
          "display": "1服务器授权",
          "max_servers": 1
        },
        {
          "spec_name": "license_10",
          "display": "10服务器授权",
          "max_servers": 10
        },
        {
          "spec_name": "license_20",
          "display": "20服务器授权",
          "max_servers": 20
        },
        {
          "spec_name": "license_50",
          "display": "50服务器授权",
          "max_servers": 50
        }
      ]
    },
    "host_security": {
      "name": "主机安全",
      "description": "ECS必须配置，根据服务器数量自动选择规格",
      "category": "security",
      "mandatory": true,
      "auto_provision": true,
      "specs": [
        {
          "spec_name": "license_1",
          "display": "1服务器授权",
          "max_servers": 1
        },
        {
          "spec_name": "license_10",
          "display": "10服务器授权",
          "max_servers": 10
        },
        {
          "spec_name": "license_20",
          "display": "20服务器授权",
          "max_servers": 20
        },
        {
          "spec_name": "license_50",
          "display": "50服务器授权",
          "max_servers": 50
        }
      ]
    },
    "log_audit": {
      "name": "日志审计",
      "description": "安全日志审计服务",
      "category": "security",
      "mandatory": false,
      "auto_provision": true,
      "specs": [
        {
          "spec_name": "license_10",
          "display": "10日志源",
          "max_log_sources": 10
        },
        {
          "spec_name": "license_20",
          "display": "20日志源",
          "max_log_sources": 20
        },
        {
          "spec_name": "license50_",
          "display": "50日志源",
          "max_log_sources": 50
        }
      ]
    },
    "database_audit": {
      "name": "数据库审计",
      "description": "数据库审计服务",
      "category": "security",
      "mandatory": false,
      "auto_provision": true,
      "specs": [
        {
          "spec_name": "license_1",
          "display": "1数据库实例",
          "max_db_instances": 1
        },
        {
          "spec_name": "license_2",
          "display": "2数据库实例",
          "max_db_instances": 2
        },
        {
          "spec_name": "license_4",
          "display": "4数据库实例",
          "max_db_instances": 4
        }
      ]
    },
    "firewall": {
      "name": "出口防火墙",
      "description": "带宽选项：10M/20M/50M/100M/200M",
      "category": "security",
      "mandatory": true,
      "recommended": true,
      "bandwidth_options": [
        10,
        20,
        50,
        100,
        200
      ]
    },
    "waf": {
      "name": "WAF（Web应用防火墙）",
      "description": "带宽选项：10M/20M/50M/100M/200M",
      "category": "security",
      "mandatory": true,
      "recommended": true,
      "bandwidth_options": [
        10,
        20,
        50,
        100,
        200
      ]
    }
  },
  "security_levels": {
    "description": "信息安全等级保护级别配置(1-5级)",
    "levels": [
      {
        "level": 1,
        "name": "用户自主保护级",
        "requirements": {
          "bastion_host": "optional",
          "host_security": "optional",
          "firewall": "optional",
          "waf": "optional",
          "log_audit": "optional",
          "database_audit": "optional"
        }
      },
      {
        "level": 2,
        "name": "系统审计保护级",
        "requirements": {
          "bastion_host": "required",
          "host_security": "required",
          "firewall": "required",
          "waf": "optional",
          "log_audit": "required",
          "database_audit": "optional"
        }
      },
      {
        "level": 3,
        "name": "安全标记保护级",
        "requirements": {
          "bastion_host": "required",
          "host_security": "required",
          "firewall": "required",
          "waf": "required",
          "log_audit": "required",
          "database_audit": "required"
        }
      },
      {
        "level": 4,
        "name": "结构化保护级",
        "requirements": {
          "bastion_host": "required",
          "host_security": "required",
          "firewall": "required",
          "waf": "required",
          "log_audit": "required",
          "database_audit": "required",
          "additional": {
            "network_segregation": true,
            "redundant_backup": true
          }
        }
      },
      {
        "level": 5,
        "name": "访问验证保护级",
        "requirements": {
          "bastion_host": "required",
          "host_security": "required",
          "firewall": "required",
          "waf": "required",
          "log_audit": "required",
          "database_audit": "required",
          "additional": {
            "network_segregation": true,
            "redundant_backup": true,
            "multi_factor_auth": true,
            "physical_security": true
          }
        }
      }
    ]
  },  
  "environment_config": {
    "storage_type": "HDD高速云盘",
    "datacenter": "统一机房，无地域区分",
    "internet_access": "应用系统默认通过互联网提供服务"
  },
  "analysis_steps": [
    "识别应用系统数量",
    "识别每个应用系统所有类型的服务器及其数量",
    "计算ECS总数量（等于所有服务器数量之和）",
    "确定存储需求（系统盘、数据盘），计算所有ECS对应的系统盘总容量、计算数据盘总容量",
    "识别网络服务需求（SLB、EIP、带宽等）",
    "按照应用系统的等保等级识别安全服务需求（堡垒机、主机安全、防火墙、WAF、日志审计、数据库审计等）",
    "生成完整的服务清单"
  ]
}
